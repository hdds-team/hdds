# cbindgen configuration for HDDS C FFI bindings

language = "C"
include_guard = "HDDS_H"
header = """
/*
 * HDDS C FFI Bindings
 * Auto-generated by cbindgen - DO NOT EDIT
 *
 * This header provides C-compatible bindings for the HDDS DDS implementation.
 */

/* ROS2 RMW support - only include if building with ROS2 */
#ifdef HDDS_WITH_ROS2
#include <rosidl_runtime_c/message_type_support_struct.h>
#include <rosidl_runtime_c/string.h>
#include <rosidl_runtime_c/u16string.h>
#else
/* Standalone fallback definitions when not building with ROS 2 */
typedef struct rosidl_runtime_c__String {
  char *data;
  size_t size;
  size_t capacity;
} rosidl_runtime_c__String;
typedef struct rosidl_runtime_c__U16String {
  uint16_t *data;
  size_t size;
  size_t capacity;
} rosidl_runtime_c__U16String;
#endif
"""

[export]
# Export only items with #[repr(C)] or #[no_mangle]
include = ["HddsParticipant", "HddsDataWriter", "HddsDataReader", "HddsError", "HddsTypeObject", "HddsReaderListener", "HddsWriterListener", "HddsSubscriptionMatchedStatus", "HddsPublicationMatchedStatus", "HddsLivelinessChangedStatus", "HddsSampleLostStatus", "HddsSampleRejectedStatus", "HddsDeadlineMissedStatus", "HddsIncompatibleQosStatus"]
# Exclude ROS 2 types that conflict with rosidl_runtime_c headers (field name casing)
exclude = ["rosidl_runtime_c__String", "rosidl_runtime_c__U16String"]

[export.rename]
# Ensure consistent naming

[fn]
# Function naming and style
prefix = ""
rename_args = "GeckoCase"

[struct]
# Struct configuration
rename_fields = "ScreamingSnakeCase"

[enum]
# Enum configuration
rename_variants = "ScreamingSnakeCase"

[parse]
# Parse configuration
parse_deps = false
include = ["hdds"]

[defines]
# Map Rust cfg(feature) to C preprocessor defines
# Items gated by #[cfg(feature = "rmw")] will be wrapped in #ifdef HDDS_WITH_ROS2
"feature = rmw" = "HDDS_WITH_ROS2"
